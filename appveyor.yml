version: 0.1.{build}
image:
- Visual Studio 2017
- Visual Studio 2015

configuration:
- Debug
- Release
- StaticRelease
- StaticDebug

platform:
- x64
- x86

before_build:
- ps: >-
    mkdir C:\sysroot

    mkdir C:\sysroot\bin

    mkdir C:\sysroot\include

    mkdir C:\sysroot\lib

environment:
  SYSROOT: C:\sysroot\
  INCLUDE: C:\sysroot\include\
  LIBS: C:\sysroot\libs\

matrix:
  - platform: x86
    environment:
      BUILD_ARCH: win32
  - platform: x64
    environment:
      BUILD_ARCH: win64

matrix:
  - configuration: Debug
    environment:
      BUILD_TYPE: debug-dynamic
  - configuration: Release
    environment:
      BUILD_TYPE: release-dynamic
  - configuration: StaticRelease
    environment:
      BUILD_TYPE: release-static
  - configuration: StaticDebug
    environment:
      BUILD_TYPE: debug-static

matrix:
  - image: Visual Studio 2017
    environment:
      BUILD_MSVC: msvc14_1
  - image: Visual Studio 2015
    environment:
      BUILD_MSVC: msvc14


build:
  project: win32/libcalendars.sln
  verbosity: minimal

after_build:
- cmd: 7z a .\%APPVEYOR_PROJECT_NAME%-%BUILD_ARCH%-%BUILD_MSVC%-%BUILD_TYPE%.zip C:\sysroot\*

artifacts:
- path: .\*.zip
  type: zip

